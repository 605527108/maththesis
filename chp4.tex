\chapter{模拟仿真结果}
本文模拟仿真的环境为翻转概率为$\epsilon$的BSC信道。
对于$q$元LDPC分组码，采用QSPA解码算法，停止规则为最大迭代次数$I_{max}=100$。
对于$q$元LDPC卷积码，滑动窗口解码使用QSPA解码算法，停止规则为最大迭代次数$I_{max}=100$或者误比特率BER达到$10^{-4}$。
\section{LDPC分组码码长与LDPC卷积码限制长度相等}
构造$q$元LDPC分组码，使其码长$n_{BC}=2Mc$。
构造$q$元LDPC卷积码，其限制长度$v_s=(m_s+1)Mc=2Mc$。
在$n_{BC}=v_s=2Mc$的条件下进行性能上的比较。
\begin{center}
\pgfplotsset{compat=1.13}
\begin{tikzpicture} 
\begin{axis}[
    xlabel={原模图复制数$M$},
    ylabel={所需翻转概率$\epsilon$},
    grid=major,
    legend style={
        font=\tiny,
        cells={anchor=east},
        legend pos=north west,
    },
]
\addplot[color=red,mark=square] table {data_d15.dat};
\addplot[color=red,mark=triangle] table {data_d16.dat};
\addplot[color=red,mark=o] table {data_d17.dat};
\addplot[color=blue,mark=square] table {data_d18.dat};
\addplot[color=blue,mark=triangle] table {data_d19.dat};
\addplot[color=blue,mark=o] table {data_d20.dat};
\legend{2-ary LDPC-BC,
        4-ary LDPC-BC,
        8-ary LDPC-BC,
        2-ary LDPC-CC,
        4-ary LDPC-CC,
        8-ary LDPC-CC}
\end{axis}
\end{tikzpicture}
\figurecaption{使用$R=1/2$的(2,4)正则原模图构造}
\label{fig:expone}
\end{center}

图\ref{fig:expone}展示的是$q$元LDPC分组码及$q$元LDPC卷积码解码时误比特率BER达到$10^{-4}$所需翻转概率$\epsilon$与原模图复制数$M$之间的关系。
$q$元LDPC分组码及$q$元LDPC卷积码都由码率为$R=1/2$的(2,4)正则原模图构造。
$q$元LDPC卷积码的滑窗解码器的窗口大小为$W=12$。

从图\ref{fig:expone}可以看出，$q$元LDPC分组码及$q$元LDPC卷积码的性能都随着原模图复制数$M$增大而提高。
同时复制数$M$较小时，相对于$q$元LDPC分组码，$q$元LDPC卷积码获得“卷积优势”，但是这种优势随$M$增大而减小。
比如当$M=100$时，8元LDPC卷积码所需的$\epsilon$比8元LDPC分组码的$\epsilon$大0.01，而$M=400$时，8元LDPC卷积码的$\epsilon$仅比8元LDPC分组码的$\epsilon$大0.001。

这个结果与LDPC卷积码阈值渐近分析（即$M$趋向无穷）相一致，也即LDPC卷积码的解码阈值会随着$M$的增大，逐渐趋向用于构建该LDPC卷积码的LDPC分组码的解码阈值。

\begin{center}
\pgfplotsset{compat=1.13}
\begin{tikzpicture} 
\begin{axis}[
    xlabel={原模图复制数$M$},
    ylabel={所需翻转概率$\epsilon$},
    grid=major,
    legend style={
        font=\tiny,
        cells={anchor=east},
        legend pos=north west,
    },
]
\addplot[color=red,mark=square] table {data_d21.dat};
\addplot[color=red,mark=triangle] table {data_d22.dat};
\addplot[color=red,mark=o] table {data_d23.dat};
\addplot[color=blue,mark=square] table {data_d24.dat};
\addplot[color=blue,mark=triangle] table {data_d25.dat};
\addplot[color=blue,mark=o] table {data_d26.dat};
\legend{2-ary LDPC-BC,
        4-ary LDPC-BC,
        8-ary LDPC-BC,
        2-ary LDPC-CC,
        4-ary LDPC-CC,
        8-ary LDPC-CC}
\end{axis}
\end{tikzpicture}
\figurecaption{使用$R=1/2$的(3,6)正则原模图构造}
\label{fig:exptwo}
\end{center}

图\ref{fig:exptwo}描述的是$q$元LDPC分组码及$q$元LDPC卷积码解码时误比特率BER达到$10^{-4}$所需翻转概率$\epsilon$与原模图复制数$M$之间的关系。
$q$元LDPC分组码及$q$元LDPC卷积码都由$R=1/2$的(3,6)正则原模图构造。
图\ref{fig:exptwo}与图\ref{fig:expone}类似，都表现了$q$元LDPC分组码及$q$元LDPC卷积码的性能随着$M$增大而提高的特性。
同时$q$元LDPC卷积码的“卷积优势”随$M$增大而减小。

另外，对比图\ref{fig:exptwo}与图\ref{fig:expone}可以发现，使用(3,6)正则原模图比使用(2,4)正则原模图构造LDPC码的解码性能更好。


\section{LDPC分组码与LDPC卷积码的解码延时相等}
除了解码性能以外，信道编码的解码延时对于设计高速通信系统来说十分重要。
无线通信如Wi-Fi，实时语音或视频通信，军事通信系统等对解码延时的要求比较苛刻。
下面考虑$q$元LDPC分组码解码延时等于$q$元LDPC卷积码解码延时的情况。
$q$元LDPC分组码的延时$T_{BC}=M_{BC}mc$，及$q$元LDPC卷积码的延时$T_{CC}=WM_{CC}mc$。
为使$T_{BC}=T_{CC}$，只需令$M_{BC} = WM_{CC}$。

\begin{center}
\pgfplotsset{compat=1.13}
\begin{tikzpicture}
\begin{semilogyaxis}[
    xlabel={反转概率$\epsilon$},
    ylabel={BER},
    grid=major,
    legend style={
        font=\tiny,
        cells={anchor=west},
        legend pos=south east,
    },
    ymin=0.00001,
    ymax=1,
]
\addplot[color=red,mark=square] table {data_d1.dat};
\addplot[color=red,mark=triangle] table {data_d2.dat};
\addplot[color=blue,mark=o] table {data_d3.dat};
\addplot[color=blue,mark=square] table {data_d4.dat};
\addplot[color=blue,mark=triangle] table {data_d5.dat};
\addplot[color=blue,mark=diamond] table {data_d6.dat};
\legend{LDPC-BC $M=192$\\
        LDPC-BC $M=384$\\
        LDPC-CC $M = 32,W =12$\\
        LDPC-CC $M = 64,W =6$\\
        LDPC-CC $M = 64,W =12$\\
        LDPC-CC $M = 128,W =6$\\}
\end{semilogyaxis}
\end{tikzpicture}
\figurecaption{使用$R=1/2$的(3,6)8元正则原模图构造}
\label{fig:perone}
\begin{tikzpicture} 
\begin{axis}[
    xlabel={解码延时(bits)},
    ylabel={所需翻转概率$\epsilon$},
    grid=major,
    legend style={
        font=\tiny,
        cells={anchor=west},
        legend pos=south east,
    },
    xmin=0,
]
\addplot table {data_d7.dat};
\addplot table {data_d8.dat};
\addplot table {data_d9.dat};
\addplot table {data_d10.dat};
\legend{LDPC-BC,$M = 32,64,128,192,288,384,576$\\
        LDPC-CC,$M = 32,W =2,3,\dots,12$\\
        LDPC-CC,$M = 64,W =2,3,\dots,12$\\
        LDPC-CC,$M = 128,W =2,3,\dots,8$\\}
\end{axis}
\end{tikzpicture}
\figurecaption{解码延时与所需翻转概率之间的关系}
\label{fig:pertwo}
\end{center}

图\ref{fig:perone}中8元LDPC分组码及8元LDPC卷积码都由码率为$R=1/2$的(3,6)正则原模图构造。
从图\ref{fig:perone}可以看出，8元LDPC卷积码的性能优于8元LDPC分组码。
另外，从图\ref{fig:perone}可以看出，用参数为$M_{CC}=64,W =6$解码器解码LDPC卷积码的性能优于用参数为$M_{CC}=32,W =12$解码LDPC卷积码的性能；
用参数为$M_{CC}=128,W =6$解码器解码LDPC卷积码的性能优于用参数为$M_{CC}=64,W =12$解码LDPC卷积码的性能(它们的解码延时相等)。
也就是说，选择相对小的窗口$W$，同时选择大的复制数$M_{CC}$补偿解码延时，能获得更好的解码性能。

图\ref{fig:pertwo}在GF($8$)上比较要达到相同的误比特率所需的翻转概率与解码延时之间的关系。
其中8元LDPC分组码及8元LDPC卷积码都由码率为$R=1/2$的(3,6)正则原模图构造。
从图\ref{fig:pertwo}可以看出，当固定原模图复制数$M_{CC}$时，LDPC卷积码性能随窗口大小$W$增加而提高，但是其解码延时$T_{CC}$却增加了。另外，在一定范围内大的复制数$M_{CC}$与小的窗口大小$W$的组合有更好的性能。
比如，解码延时$T_{CC}=2304$时，$M_{CC}=64$与$W=6$的LDPC卷积码的性能比$M_{CC}=32$与$W=12$的LDPC卷积码的性能更好。
然而，复制数$M_{CC}$越大与窗口$W$越小不一定有最好性能。比如，解码延时$T_{CC}=2304$时，$M_{CC}=128$与$W=3$的LDPC卷积码的性能反而比$M_{CC}=64$与$W=6$的LDPC卷积码的性能差。
由此可见，解码延时确定时，要综合考虑复制数$M_{CC}$与窗口大小$W$的影响。
\begin{center}
\tablecaption{在不同GF($q$)与解码延时的条件下使误比特率达到$10^{-4}$所需的翻转概率}
\label{table:filppingforbsc}
\begin{tabular}{|c|c|c|c|c|c|c|}
 \hline
解码 & \multicolumn{3}{|c|}{LDPC-BC} & \multicolumn{3}{|c|}{LDPC-CC} \\ \cline{2-7}
延时 & GF(2) & GF(4) & GF(8) & GF(2) & GF(4) & GF(8) \\ \hline
2304 bits & 0.14 & 0.15 & 0.15 & 0.12 & 0.16 & 0.18\\ \hline
4608 bits & 0.16 & 0.17 & 0.16 & 0.18 & 0.19 & 2.0\\ \hline
6912 bits & 0.17 & 0.18 & 0.17 & 0.19 & 0.21 & 0.21\\ \hline
9216 bits & 0.17 & 0.19 & 0.19 & 0.21 & 0.22 & 0.22\\ \hline
\end{tabular}
\end{center}

表\ref{table:filppingforbsc}展示了，(3,6)正则q元LDPC分组码与(3,6)正则q元LDPC卷积码在不同的GF($q$)以及不同的解码延时的条件下，误比特率BER达到$10^{-4}$所需翻转概率$\epsilon$。
从表\ref{table:filppingforbsc}可以看出，当解码延时确定时，非二元的LDPC卷积码的解码性能优于q元LDPC分组码以及二元LDPC卷积码的解码性能。
与q元LDPC分组码相反，q元LDPC卷积码误比特率BER达到$10^{-4}$所需翻转概率$\epsilon$随$q$的增加而增大。
这种现象与\parencite{6874959}中的迭代译码阈值结果相一致，即，当$q$增加时，(3,6)正则q元LDPC卷积码的解码阈值逐趋向到信道容量，而(3,6)正则q元LDPC分组码的解码阈值开始偏离信道容量。
我们还能从表中发现，对于解码延时为2304比特，(3,6)正则二元LDPC卷积码误比特率BER达到$10^{-4}$所需翻转概率$\epsilon$要低于，(3,6)正则二元LDPC分组码的翻转概率。
这是由于限制长度短的二元LDPC卷积码存在错误扩散现象。
在高误比特率或者更大解码延时的条件下，以上的错误扩散现象将会消失，
从表中也可以发现，当解码延时大于2304比特时，二元LDPC卷积码解码性能比二元LDPC分组码更好。



\section{LDPC分组码与LDPC卷积码的解码复杂度比较}
Pusane等人在\parencite{5695133}中分析了，相对于二元LDPC分组码，使用流水线解码算法的二元LDPC卷积码而获得的卷积特性与计算复杂度，处理器复杂度，解码器所需内存大小以及解码延时的关系。

在这一节中，我们将在相同解码延时或者相同的解码性能的条件下，比较q元LDPC卷积码与q元LDPC分组码的解码计算复杂度。
对于使用QSPA进行解码的q元LDPC码，在每次迭代周期中，一个校验节点所需的计算复杂度为$\mathcal{O}(qm)$，一个变量节点所需的计算复杂度为$\mathcal{O}(q)$。
令$I_{BC}$代表要解码一个LDPC分组码的码字所需要的平均迭代次数，类似的，令$I_{CC}$代表，在某一确定时间点，在LDPC卷积码的窗口解码器中一个窗口内，要解码所有符号所需要的平均迭代次数。
对于$(d_v,d_c)$正则LDPC分组码来说，其设计码率为$R=\frac{d_c-d_v}{d_c}$，其解码每个码字所需计算复杂度为
\begin{equation}
\mathcal{O} \left(\frac{T_{BC}}{m}d_vq+\frac{T_{BC}}{m}\left(1-R\right)d_cqm\right)I_{BC}=\mathcal{O}\left(\left(\frac{d_v}{m}+d_v\right)qT_{BC}\right)I_{BC}
\end{equation}
因此，对于解码$(d_v,d_c)$正则LDPC分组码的每一比特，所需计算复杂度为
\begin{equation}
\mathcal{O}\left(\left(\frac{d_v}{m}+d_v\right)q\right)I_{BC}
\end{equation}

对于$(d_v,d_c)$正则LDPC卷积码，为了简单起见，我们认为在窗口解码器的窗口中的那一部分Tanner图是$(d_v,d_c)$正则的，虽然在窗口起始部位的校验节点以及结束部位的变量节点有相对低的度分布。
因此，对于每个窗口，其计算复杂度大约为
\begin{equation}
\mathcal{O}\left(\left(\frac{d_v}{m}+d_v\right)qT_{CC}\right)I_{CC}
\end{equation}

而注意到在某一特定时间，窗口解码器要解码的比特数是$T_{CC}/W$，所以对于$(d_v,d_c)$正则LDPC卷积码每一个比特的解码计算复杂度是
\begin{equation}
\frac{\mathcal{O}\left(\left(\frac{d_v}{m}+d_v\right)qT_{CC}\right)I_{CC}}{T_{CC}/W} = \mathcal{O}\left(\left(\frac{d_v}{m}+d_v\right)q\right)WI_{CC}
\end{equation}

通过比较LDPC卷积码与LDPC分组码解码每一个比特所需的计算复杂度，我们可以发现，
如果$I_{BC}=WI_{CC}$，在相同的GF($q$)上，LDPC卷积码与LDPC分组码会有相同的解码计算复杂度。
在以下的实证分析中，我们所基于的原模图是(3,6)正则LDPC码。
具有其它度分布的原模图也能得出以下类似的实验结果。
另外，在解码LDPC卷积码时，我们将窗口参数设置为$W=6$。
\begin{center}
\tablecaption{在不同GF($q$)与解码延时的条件下使误比特率达到$10^{-4}$所需的迭代次数}
\label{table:iterationforbsc}
\begin{tabular}{|c|c|c|c|c|c|c|}
 \hline
解码 & \multicolumn{3}{|c|}{$I_{BC}$} & \multicolumn{3}{|c|}{$I_{CC}(W=6)$} \\ \cline{2-7}
延时 & GF(2) & GF(4) & GF(8) & GF(2) & GF(4) & GF(8) \\ \hline
4608 bits & 13.8 & 12.3 & 11.1 & 3.3 & 3.2 & 3.0\\ \hline
6912 bits & 15.6 & 14.1 & 12.6 & 3.9 & 3.7 & 3.4\\ \hline
\end{tabular}
\end{center}

在本节中，我们基于相等的解码延时的条件，比较q元LDPC卷积码与q元LDPC分组码的计算复杂度。
表\ref{table:iterationforbsc}展示了，在解码延时分别为4608，6912比特时，(3,6)正则q元LDPC卷积码与(3,6)正则q元LDPC分组码解码误比特率达到$10^{-4}$所需的平均迭代次数$I_{CC}$和$I_{BC}$。
我们可以发现，在相同的GF($q$)中，q元LDPC分组码的$I_{BC}$高于q元LDPC卷积码的$I_{CC}$。
这个现象的解释显而易见：对于给定的解码延时，LDPC分组码需要解码的符号数是LDPC卷积码需要解码的符号数的$W$倍。
我们还可以看到，对于LDPC分组码与LDPC卷积码，所需的迭代次数都随着$q$的减小而减小；
但是，总的解码计算复杂度却增加了，这是因为每次迭代的复杂度增加得更多。

\begin{center}
\begin{tikzpicture} 
\begin{axis}[
    xlabel={com com per bit},
    ylabel={GFQ},
    grid=major,
    legend style={
        font=\tiny,
        cells={anchor=west},
        legend pos=north west,
    },
    xmin=0,
    ymin=0,
]
\addplot table {data_d27.dat};
\addplot table {data_d28.dat};
\addplot table {data_d29.dat};
\addplot table {data_d30.dat};
\legend{4608 LDPC-BC\\
        6912 LDPC-BC\\
        4608 LDPC-CC\\
        6912 LDPC-CC\\}
\end{axis}
\end{tikzpicture}
\figurecaption{每解码一比特的计算复杂度与解码延时的关系}
\label{fig:perbit}
\end{center}

图\ref{fig:perbit}展示了，(3,6)正则q元LDPC卷积码与(3,6)正则q元LDPC分组码每解码一比特的计算复杂度与解码延时的关系。
我们可以观察到，LDPC卷积码与LDPC分组码的解码计算复杂度都随$q$的增大而指数增加。
另外，在相同的GF($q$)中，LDPC卷积码的复杂度比LDPC分组码的复杂度高35\%。
同时我们还可以看到，在相等解码延时的条件下，二元LDPC卷积码的复杂度比4元LDPC分组码的复杂度高10\%，而4元LDPC卷积码的复杂度比二元LDPC分组码的复杂度高80\%。
但是，二元LDPC卷积码解码时误比特率达到$10^{-4}$所需翻转概率，比4元LDPC分组码所需翻转概率大0.01，而4元LDPC卷积码所需翻转概率比二元LDPC分组码所需翻转概率大0.04（见表\ref{table:filppingforbsc}）。
所以，即使LDPC卷积码相对于LDPC分组码有较高的计算复杂度，但是它性能的增加量比LDPC分组码更加明显。
况且，很难通过增加LDPC分组码的解码复杂度来增加其解码性能，也就是说，简单增加解码迭代次数，LDPC分组码也很难减小解码性能上与LDPC卷积码的差距。

因此，根据以上分析可以得出结论：对于给定解码延时的情况，在误码率性能和计算复杂度的平衡之间，LDPC卷积码是更好的选择。












